KWON_testing_resp
--------------------

(mic) krsharma@lisbon:~/mic_code/example_kwon$ python demo_mic_estimation.py

user_max = 1000
extra_users_len = 10
edge_thr = 1
lookback_count = 5

max_iter = 10
cascade_count = 111
num_negative_samples = None

added nodes 1987
processed 0 / 111
processed 100 / 111
added all potential edges
removed edges below thr
set edge attributes 0 / 48557
set edge attributes 5000 / 48557
set edge attributes 10000 / 48557
set edge attributes 15000 / 48557
set edge attributes 20000 / 48557
set edge attributes 25000 / 48557
set edge attributes 30000 / 48557
set edge attributes 35000 / 48557
set edge attributes 40000 / 48557
set edge attributes 45000 / 48557
base_graph information...
num_nodes=1987
num_edges=48557
num_train_cascades=111
num_test_cascades=0
done loading data...
done setting index dict
done setting random initialization
start: training
step = 0 / 10 in time till now = 0.000
done E-step: update responsibilities gamma -305813.1446003325
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.468468  0.427184   0.423077  0.431373       51
1  0.468468  0.504202   0.508475  0.500000       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.531532  0.527273   0.491525  0.568627       51
1  0.531532  0.535714   0.576923  0.500000       60
done evaluation of clustering accuracy at iter = 0 at pi = [0.5, 0.5]
step = 1 / 10 in time till now = 1.039
done E-step: update responsibilities gamma -301614.05620698805
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.432432  0.461538   0.409091  0.529412       51
1  0.432432  0.400000   0.466667  0.350000       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.567568  0.500000   0.533333  0.470588       51
1  0.567568  0.619048   0.590909  0.650000       60
done evaluation of clustering accuracy at iter = 1 at pi = [0.4978505063137064, 0.5021494936862936]
step = 2 / 10 in time till now = 2.056
done E-step: update responsibilities gamma -360697.3991877406
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.378378  0.420168   0.367647  0.490196       51
1  0.378378  0.330097   0.395349  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.621622  0.553191   0.604651  0.509804       51
1  0.621622  0.671875   0.632353  0.716667       60
done evaluation of clustering accuracy at iter = 2 at pi = [0.5900691172204832, 0.40993088277951684]
step = 3 / 10 in time till now = 3.110
done E-step: update responsibilities gamma -363304.0958668625
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.396396  0.436975   0.382353  0.509804       51
1  0.396396  0.349515   0.418605  0.300000       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.603604  0.531915   0.581395  0.490196       51
1  0.603604  0.656250   0.617647  0.700000       60
done evaluation of clustering accuracy at iter = 3 at pi = [0.5962600954403567, 0.40373990455964326]
step = 4 / 10 in time till now = 4.133
done E-step: update responsibilities gamma -364304.80252618185
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 4 at pi = [0.5936493174474676, 0.40635068255253237]
step = 5 / 10 in time till now = 5.175
done E-step: update responsibilities gamma -365051.93919988396
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 5 at pi = [0.5875594741907865, 0.41244052580921353]
step = 6 / 10 in time till now = 6.201
done E-step: update responsibilities gamma -365691.80078337516
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 6 at pi = [0.5866906768957719, 0.4133093231042281]
step = 7 / 10 in time till now = 7.263
done E-step: update responsibilities gamma -366059.2446351985
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 7 at pi = [0.586648635813963, 0.413351364186037]
step = 8 / 10 in time till now = 8.282
done E-step: update responsibilities gamma -366318.6261399604
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 8 at pi = [0.5864511354280403, 0.4135488645719597]
step = 9 / 10 in time till now = 9.324
done E-step: update responsibilities gamma -366515.926507738
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 9 at pi = [0.586499024629481, 0.413500975370519]
done: training
Training time = {} for {} users 10.79541277885437
saved pi0, pi1 at ../output/kwon_testing_resp/pi.txt
saved_graph at location: ../output/kwon_testing_resp/learned_graph.tsv
saved_idx2u at location: ../output/kwon_testing_resp/idx2u.txt
finished saving learned parameters..
done setting index dict
done: recompute responsibilities gamma
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at end at pi = [0.5869333432898557, 0.4130666567101443], ll=-366668.3715413655.
finished saving responsibilities.
Program finished in 13.1 seconds
terminate called after throwing an instance of 'TPt<TExcept>'
Aborted (core dumped)

KWON Old:
--------
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.630631  0.506024   0.656250  0.411765       51
1  0.630631  0.705036   0.620253  0.816667       60


Kwon_testing_resp_1:

(mic) krsharma@lisbon:~/mic_code/example_kwon$ python demo_mic_estimation.py
input params...
../data/kwon/cascades.txt
../data/kwon/labels.txt
../data/kwon/train_ids.txt
User max, Extra users len, Edge thr, Cascade count 1000 10 1 111
Num neg samples, lookback_count, max_iter None 5 10
loading data...
reading dataset...
indexing dataset...
filter by train_ids...
creating base_graph...
added nodes 1987
processed 0 / 111
processed 100 / 111
added all potential edges
removed edges below thr
set edge attributes 0 / 48557
set edge attributes 5000 / 48557
set edge attributes 10000 / 48557
set edge attributes 15000 / 48557
set edge attributes 20000 / 48557
set edge attributes 25000 / 48557
set edge attributes 30000 / 48557
set edge attributes 35000 / 48557
set edge attributes 40000 / 48557
set edge attributes 45000 / 48557
base_graph information...
num_nodes=1987
num_edges=48557
num_train_cascades=111
num_test_cascades=0
done loading data...
done setting index dict
done setting random initialization
start: training
step = 0 / 10 in time till now = 0.000
done E-step: update responsibilities gamma -305813.1446003325
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.468468  0.427184   0.423077  0.431373       51
1  0.468468  0.504202   0.508475  0.500000       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.531532  0.527273   0.491525  0.568627       51
1  0.531532  0.535714   0.576923  0.500000       60
done evaluation of clustering accuracy at iter = 0 at pi = [0.5, 0.5]
step = 1 / 10 in time till now = 1.039
done E-step: update responsibilities gamma -301614.05620698805
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.432432  0.461538   0.409091  0.529412       51
1  0.432432  0.400000   0.466667  0.350000       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.567568  0.500000   0.533333  0.470588       51
1  0.567568  0.619048   0.590909  0.650000       60
done evaluation of clustering accuracy at iter = 1 at pi = [0.4978505063137064, 0.5021494936862936]
step = 2 / 10 in time till now = 2.056
done E-step: update responsibilities gamma -360697.3991877406
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.378378  0.420168   0.367647  0.490196       51
1  0.378378  0.330097   0.395349  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.621622  0.553191   0.604651  0.509804       51
1  0.621622  0.671875   0.632353  0.716667       60
done evaluation of clustering accuracy at iter = 2 at pi = [0.5900691172204832, 0.40993088277951684]
step = 3 / 10 in time till now = 3.110
done E-step: update responsibilities gamma -363304.0958668625
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.396396  0.436975   0.382353  0.509804       51
1  0.396396  0.349515   0.418605  0.300000       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.603604  0.531915   0.581395  0.490196       51
1  0.603604  0.656250   0.617647  0.700000       60
done evaluation of clustering accuracy at iter = 3 at pi = [0.5962600954403567, 0.40373990455964326]
step = 4 / 10 in time till now = 4.133
done E-step: update responsibilities gamma -364304.80252618185
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 4 at pi = [0.5936493174474676, 0.40635068255253237]
step = 5 / 10 in time till now = 5.175
done E-step: update responsibilities gamma -365051.93919988396
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 5 at pi = [0.5875594741907865, 0.41244052580921353]
step = 6 / 10 in time till now = 6.201
done E-step: update responsibilities gamma -365691.80078337516
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 6 at pi = [0.5866906768957719, 0.4133093231042281]
step = 7 / 10 in time till now = 7.263
done E-step: update responsibilities gamma -366059.2446351985
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 7 at pi = [0.586648635813963, 0.413351364186037]
step = 8 / 10 in time till now = 8.282
done E-step: update responsibilities gamma -366318.6261399604
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 8 at pi = [0.5864511354280403, 0.4135488645719597]
step = 9 / 10 in time till now = 9.324
done E-step: update responsibilities gamma -366515.926507738
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at iter = 9 at pi = [0.586499024629481, 0.413500975370519]
done: training
Training time = {} for {} users 10.79541277885437
saved pi0, pi1 at ../output/kwon_testing_resp/pi.txt
saved_graph at location: ../output/kwon_testing_resp/learned_graph.tsv
saved_idx2u at location: ../output/kwon_testing_resp/idx2u.txt
finished saving learned parameters..
done setting index dict
done: recompute responsibilities gamma
Clustering results: Classification report
   accuracy  f1-score  precision    recall  support
0  0.387387  0.433333   0.376812  0.509804       51
1  0.387387  0.333333   0.404762  0.283333       60
Flipped prediction groups
   accuracy  f1-score  precision    recall  support
0  0.612613  0.537634   0.595238  0.490196       51
1  0.612613  0.666667   0.623188  0.716667       60
done evaluation of clustering accuracy at end at pi = [0.5869333432898557, 0.4130666567101443], ll=-366668.3715413655.
finished saving responsibilities.
Program finished in 13.1 seconds
terminate called after throwing an instance of 'TPt<TExcept>'
Aborted (core dumped)
(mic) krsharma@lisbon:~/mic_code/example_kwon$ A